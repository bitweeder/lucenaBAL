
# Lucena Build Abstraction Library

The purpose of the Lucena Build Abstraction Library (lucenaBAL) is to abstract away portions of the build environment when working with C++17 and later Standards. It’s a foundational tool that allows code built with it to remain agnostic regarding the underlying compiler, C++ Standard Library variant, and aspects of the runtime. Note that lucenaBAL is **not** a build system, but rather a C++ header library with a collection of build system support scripts.

**lucenaBAL 2.0 is in active development. Breaking changes are possible—though unlikely—until the tagged 2.0 release.**

## Getting Started

[CMake](https://cmake.org/) scripts are provided which will generate the library itself, test applications, and, later, documentation. We require at least CMake 3.15, so that will need to be [installed first](https://cmake.org/download/).

More detailed instructions are provided below, but for a quick start, simply clone the repository, open up a terminal window, change to the local repo directory, and execute the following:

Under macOS or Linux:

    > mkdir build
    > cd build
    > cmake ..
    > cmake --build . --config Release
    > sudo make install

Under Windows:

    > mkdir build
    > cd build
    > cmake -DCMAKE_INSTALL_PREFIX=/path/to/install ..
    > cmake --build . --config Release
    > cmake --build . --target install

This will generate headers, test binaries, and docs in the build directory, then copy the headers  to `/usr/local/include/lucenaBAL` (or the equivalent specified directory) and copy any support files to `/usr/local/share/lucebaBAL` (or the equivalent specified directory). Tests and docs will remain in the build directory. Since lucenaBAL is a header-only library, it is not necessary to link it: simply `#include <lucenaBAL/lucenaBAL.hpp>`. Usage information is available in the headers, primarily in `<lucenaBAL/lbalFeatureSetup.hpp>`, and in the documentation. Note that the docs are generated from the headers.

## Prerequisites

lucenaBAL currently requires a C++17 compiler. It has been tested with gcc 7 thru 9, Microsoft Visual Studio 15.7 thru 16.2, and Xcode 9 thru 11. Experimental support is in for clang 6+. All testing thus far has been with the compilers’ bundled Standard Library implementations, although lucenaBAL should support mixing them.

## Building, Installing, and Testing

The project uses CMake as the primary build system. Originally, hand-built project files for a number of different IDEs were used, but they were dependent on a specific development environment and also didn’t lend themselves very well to automation.

lucenaBAL is a header-only library. The basic build instructions are provided under **Getting Started**.  We give two different methods since, by default, macOS and Linux installs are to `/usr/local`, which requires sudo (or root) privileges, while Windows has a different model. Ignoring these differences, we have the following, with line numbers added:

    1 > mkdir build
    2 > cd build
    3 > cmake -DCMAKE_INSTALL_PREFIX=/path/to/install ..
    4 > cmake --build . --config Release
    5 > cmake --build . --target install

Line 3 can be changed to:

    3 > cmake -G "<generator>" -DCMAKE_INSTALL_PREFIX=/path/to/install ..

`<generator>` should be replaced with one of the supported [generator strings](https://cmake.org/cmake/help/latest/manual/cmake-generators.7.html). The `-DCMAKE_INSTALL_PREFIX` switch could be left out if the default installation directory is acceptable.

In line 4, the config may be chosen from the usual set with the usual meanings for CMake: Debug, Release, RelWithDebInfo and MinSizeRel.

Tests are generated by default and left in `<build>/test`. They can be automatically run by changing line 5 to:

    5 > cmake --build . --target test

Tests can be scripted in the usual way for CMake and CTest, for example in order to only install on success.

Docs are also generated by default and left in `<build>/docs`.
> Note that Documentation is not currently being generated in the 2.0 alpha branch. However, the extensive source material is available in the headers themselves.

## To-Do
_Roughly in order of precedence_
- Doxygen-format the header documentation
- incorporate C++2a changes through Cologne
- add code to generate docs from the Doxygen comments
- break out pre-C++17 features (maybe)
- generate nicer-looking iDE project files

## Support

lucenaBAL aggressively tracks the latest tools and standards, and back-porting new features to old versions or attempting to support old tools and standards in new versions is unlikely to happen. The cold reality is that we do not have the bandwidth to pay the interest on anyone else’s technical debt. If an older version does what you need, use it. If you find a bug in any version, we greatly appreciate patches, though we strongly encourage you to at least file a bug report. Feature requests will be considered, but requests to increase our maintenance surface are unlikely to pass muster.

## Contributing

Please read [CONTRIBUTING.md](./CONTRIBUTING.md) for details on the process for submitting pull requests to us.

Please note that this project is released with a Contributor Code of Conduct, documented in [CODE_OF_CONDUCT.md](./CODE_OF_CONDUCT.md) By participating in this project you agree to abide by its terms.

## Versioning

We use [SemVer](https://semver.org/) for versioning. For the versions available, see the [tags on this repository](https://github.com/bitweeder/lucenaBAL/tags).

## Authors

-   [**bitweeder**](https://bitweeder.com/) - _Originator and maintainer_

## License

This project is licensed under the University of Illinois/NCSA Open Source License - see the [LICENSE.md](./LICENSE.md) file for details.

Some portions of the project are governed by other, compatible licenses, as described in the licenses directory, notably:

- [Google Test](https://github.com/google/googletest) is used under the terms of the BSD 3-Clause license. See [licenses/bit_cast License.txt](./licenses/bit_cast%20License.txt). Note that we do not include Google Test itself, but have the build system fetch it as a dependency when generating tests.

## Acknowledgments

- **[Dominik Berner](http://dominikberner.ch/)**—_Without whom I’d probably still have CMake 3 as a To-Do item._
- **Billie Thompson** - [PurpleBooth](https://github.com/PurpleBooth)—_Thanks for the ([Readme template](https://gist.github.com/PurpleBooth/109311bb0361f32d87a2))!_
- **[Coraline Ada Ehmke](http://where.coraline.codes/ "Coraline Ada Ehmke")**—_Creator of [The Contributor Covenant](https://www.contributor-covenant.org/), used here under the terms of the [Creative Commons Attribution License](https://github.com/ContributorCovenant/contributor_covenant/blob/master/LICENSE.md)_
